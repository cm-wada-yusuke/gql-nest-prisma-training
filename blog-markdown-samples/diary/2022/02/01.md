---
title: "ActiveRecordã®scopeã§PG::AmbiguousColumnã‚¨ãƒ©ãƒ¼ãŒå‡ºãŸ"
emoji: "ğŸ—’"
publishDate: "2022-02-01"
type: "diary"
published: true
---


ã“ã†ã„ã†ã‚¹ã‚³ãƒ¼ãƒ—ã€‚

```ruby
class Card < ApplicationRecord
  belongs_to :user

  scope :issueable, -> { where("created_at < ?", Time.current.beginning_of_month).where(status: ["retry", nil]) }
end
```

`include(:user)`ãªã©ã¨ã—ãŸå ´åˆã€`user`å´ã®ãƒ¢ãƒ‡ãƒ«ã«ã‚‚`created_at`ãŒã‚ã‚‹ã®ã§ã‚ã„ã¾ã„ã«ãªã£ã¦ã—ã¾ã†ã€‚`created_at < ?`ã¨ã„ã†æ›¸ãæ–¹ã‚’ãã‚‚ãã‚‚ã‚„ã‚ãŸã»ã†ãŒã‚ˆã•ãã†ã‹â€¦ï¼Ÿ

https://simple-minds-think-alike.moritamorie.com/entry/active-record-where-with-range

ã†ã‚“ã€"created_at < ?'ã¯ã‚„ã‚ã¨ã„ãŸã»ã†ãŒã‚ˆã•ãã†ã€‚`(created_at: ...Time)`ã§ã„ã‘ã‚‹ãªã‚‰ãã®ã»ã†ãŒè‰¯ã„ã€‚ã¨ã„ã†ã‹ã¾ã•ã«ã“ã“ã§æ›¸ã„ãŸã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹ãƒªã‚¹ã‚¯ãŒã‚ã‚‹ã‚ˆã£ã¦æ›¸ã„ã¦ã¾ã™ã­...ã€‚

## ä¿®æ­£å¾Œ


```ruby
class Card < ApplicationRecord
  belongs_to :user

  scope :issueable, -> { where(created_at: ...Time.current.beginning_of_month).where(status: ["retry", nil]) }
end
```

çµåˆã—ã¦ã‚‚ã‚¨ãƒ©ãƒ¼ãŒã§ãªããªã‚Šã¾ã—ãŸã€‚
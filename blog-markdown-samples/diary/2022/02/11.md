---
title: "urql ã§ TypeError: Cannot read properties of undefined (reading '__key')"
emoji: "ğŸ¤”"
publishDate: "2022-02-11"
type: "diary"
published: true
---

https://github.com/FormidableLabs/urql/issues/205

ã“ã“ã§åŒã˜å†…å®¹ã¯å ±å‘Šã•ã‚Œã¦ã„ã‚‹ã‘ã©ã€ã“ã‚Œã¯ Client Side ã§ã®è©±ãªã‚“ã ã‚ˆãªã€‚ä»Šå›ã¯ Server Rendering ã§èµ·ãã¦ã„ã‚‹ã€‚

```tsx
export const getServerSideProps: GetServerSideProps<Props> = async () => {
  try {
    const client = await urqlClient();

    const result = await client.query(PostIndexPageDocument, {}).toPromise();
    console.log(result.data);

    return {
      props: {
        articles: result.data.articles,
        diaries: result.data.diaries,
      },
    };
  } catch (e) {
    console.error(e);
    return {
      notFound: true,
    };
  }
};
```

ã†ãƒ¼ã‚“ await ã§ãã¦ã„ãªã„ã£ã¦ã“ã¨ã¯ãªã•ãã†ãªã‚“ã ã‘ã©ã€‚

# QueryãƒŸã‚¹ã£ã¦ã¾ã—ãŸ

èª¤ã‚Šï¼š

```graphql
query {
  articles: posts(type: ["article"]) {
    id
    title
    type
    publishDate
    emoji
  }
  diaries: posts(type: ["diary"]) {
    id
    title
    type
    publishDate
    emoji
  }
}
```


æ­£ã—ã„ï¼ˆã‚¯ã‚¨ãƒªåãŒå¿…è¦ï¼‰ï¼š

```graphql
query PostIndexPage {
  articles: posts(type: ["article"]) {
    id
    title
    type
    publishDate
    emoji
  }
  diaries: posts(type: ["diary"]) {
    id
    title
    type
    publishDate
    emoji
  }
}
```

Apollo Studio ãªã©ã‹ã‚‰Queryã‚’ã‚³ãƒ”ãƒšã—ãŸã›ã„ã€‚ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå‹ã‚’ç”Ÿæˆã—ã¦ã‚‚ã‚‰ã†ãŸã‚ã«ã¯ã€queryã«åå‰ã‚’ä»˜ã‘ã‚‹å¿…è¦ãŒã‚‹ã‚ã‚ˆã€‚